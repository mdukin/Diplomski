Ako pretpostavimo da je 
𝑌
=
1
Y=1 i da je ulaz 
𝑥
=
1
x=1, možemo specifično izračunati gradijente za zadani primjer. Prvo ćemo zapisati konkretne izraze za svaku varijablu, a zatim izračunati gradijente.

Model
Model je:
𝑠
1
=
𝑤
1
⋅
𝑥
+
𝑏
1
s 
1
​
 =w 
1
​
 ⋅x+b 
1
​
 
ℎ
1
=
ReLU
(
𝑠
1
)
h 
1
​
 =ReLU(s 
1
​
 )
𝑠
2
=
𝑤
2
⋅
ℎ
1
+
𝑏
2
s 
2
​
 =w 
2
​
 ⋅h 
1
​
 +b 
2
​
 
𝑠
=
[
𝑠
1
,
𝑠
2
]
s=[s 
1
​
 ,s 
2
​
 ]
𝑦
=
softmax
(
𝑠
)
y=softmax(s)

Funkcija gubitka
Koristimo unakrsnu entropiju kao funkciju gubitka:
𝐿
=
−
log
⁡
(
𝑦
1
)
L=−log(y 
1
​
 )
jer je 
𝑌
=
1
Y=1.

Izračunavanje korak po korak
Izračunavanje 
𝑠
1
s 
1
​
  i 
ℎ
1
h 
1
​
 :
𝑠
1
=
𝑤
1
⋅
𝑥
+
𝑏
1
=
𝑤
1
⋅
1
+
𝑏
1
=
𝑤
1
+
𝑏
1
s 
1
​
 =w 
1
​
 ⋅x+b 
1
​
 =w 
1
​
 ⋅1+b 
1
​
 =w 
1
​
 +b 
1
​
 
ℎ
1
=
ReLU
(
𝑠
1
)
=
ReLU
(
𝑤
1
+
𝑏
1
)
h 
1
​
 =ReLU(s 
1
​
 )=ReLU(w 
1
​
 +b 
1
​
 )

Izračunavanje 
𝑠
2
s 
2
​
 :
𝑠
2
=
𝑤
2
⋅
ℎ
1
+
𝑏
2
=
𝑤
2
⋅
ReLU
(
𝑤
1
+
𝑏
1
)
+
𝑏
2
s 
2
​
 =w 
2
​
 ⋅h 
1
​
 +b 
2
​
 =w 
2
​
 ⋅ReLU(w 
1
​
 +b 
1
​
 )+b 
2
​
 

Konkatenacija 
𝑠
1
s 
1
​
  i 
𝑠
2
s 
2
​
  u 
𝑠
s:
𝑠
=
[
𝑠
1
,
𝑠
2
]
s=[s 
1
​
 ,s 
2
​
 ]

Izračunavanje softmaxa 
𝑦
y:
𝑦
𝑖
=
𝑒
𝑠
𝑖
𝑒
𝑠
1
+
𝑒
𝑠
2
y 
i
​
 = 
e 
s 
1
​
 
 +e 
s 
2
​
 
 
e 
s 
i
​
 
 
​
 

Gradijent gubitka u odnosu na 
𝑠
s:
∂
𝐿
∂
𝑠
𝑖
=
𝑦
𝑖
−
𝑡
𝑖
∂s 
i
​
 
∂L
​
 =y 
i
​
 −t 
i
​
 
Gdje je 
𝑡
=
[
1
,
0
]
t=[1,0] jer je 
𝑌
=
1
Y=1.

Izračunavanje gradijenata
Prvo izračunajmo vrijednosti 
𝑠
1
s 
1
​
  i 
𝑠
2
s 
2
​
  konkretno:

Izračunavanje 
𝑠
1
s 
1
​
  i 
ℎ
1
h 
1
​
 :
𝑠
1
=
𝑤
1
+
𝑏
1
s 
1
​
 =w 
1
​
 +b 
1
​
 
ℎ
1
=
ReLU
(
𝑠
1
)
=
ReLU
(
𝑤
1
+
𝑏
1
)
h 
1
​
 =ReLU(s 
1
​
 )=ReLU(w 
1
​
 +b 
1
​
 )

Izračunavanje 
𝑠
2
s 
2
​
 :
𝑠
2
=
𝑤
2
⋅
ReLU
(
𝑤
1
+
𝑏
1
)
+
𝑏
2
s 
2
​
 =w 
2
​
 ⋅ReLU(w 
1
​
 +b 
1
​
 )+b 
2
​
 

Izračunavanje softmaxa 
𝑦
y:
𝑦
1
=
𝑒
𝑠
1
𝑒
𝑠
1
+
𝑒
𝑠
2
y 
1
​
 = 
e 
s 
1
​
 
 +e 
s 
2
​
 
 
e 
s 
1
​
 
 
​
 
𝑦
2
=
𝑒
𝑠
2
𝑒
𝑠
1
+
𝑒
𝑠
2
y 
2
​
 = 
e 
s 
1
​
 
 +e 
s 
2
​
 
 
e 
s 
2
​
 
 
​
 

Gradijent gubitka u odnosu na 
𝑠
s:
∂
𝐿
∂
𝑠
1
=
𝑦
1
−
1
∂s 
1
​
 
∂L
​
 =y 
1
​
 −1
∂
𝐿
∂
𝑠
2
=
𝑦
2
∂s 
2
​
 
∂L
​
 =y 
2
​
 

Gradijent u odnosu na 
𝑤
2
w 
2
​
  i 
𝑏
2
b 
2
​
 :
∂
𝐿
∂
𝑤
2
=
∂
𝐿
∂
𝑠
2
⋅
ℎ
1
∂w 
2
​
 
∂L
​
 = 
∂s 
2
​
 
∂L
​
 ⋅h 
1
​
 
∂
𝐿
∂
𝑏
2
=
∂
𝐿
∂
𝑠
2
∂b 
2
​
 
∂L
​
 = 
∂s 
2
​
 
∂L
​
 

Gradijent u odnosu na 
ℎ
1
h 
1
​
 :
∂
𝐿
∂
ℎ
1
=
∂
𝐿
∂
𝑠
2
⋅
𝑤
2
∂h 
1
​
 
∂L
​
 = 
∂s 
2
​
 
∂L
​
 ⋅w 
2
​
 

Gradijent u odnosu na 
𝑠
1
s 
1
​
 :
∂
𝐿
∂
𝑠
1
=
(
∂
𝐿
∂
𝑠
1
+
∂
𝐿
∂
ℎ
1
⋅
ReLU
′
(
𝑠
1
)
)
∂s 
1
​
 
∂L
​
 =( 
∂s 
1
​
 
∂L
​
 + 
∂h 
1
​
 
∂L
​
 ⋅ReLU 
′
 (s 
1
​
 ))

Gradijent u odnosu na 
𝑤
1
w 
1
​
  i 
𝑏
1
b 
1
​
 :
∂
𝐿
∂
𝑤
1
=
∂
𝐿
∂
𝑠
1
⋅
𝑥
∂w 
1
​
 
∂L
​
 = 
∂s 
1
​
 
∂L
​
 ⋅x
∂
𝐿
∂
𝑏
1
=
∂
𝐿
∂
𝑠
1
∂b 
1
​
 
∂L
​
 = 
∂s 
1
​
 
∂L
​
 

Specifične vrijednosti
Izračunajmo 
𝑠
1
s 
1
​
 :
𝑠
1
=
𝑤
1
+
𝑏
1
s 
1
​
 =w 
1
​
 +b 
1
​
 

Izračunajmo 
ℎ
1
h 
1
​
 :
ℎ
1
=
ReLU
(
𝑤
1
+
𝑏
1
)
h 
1
​
 =ReLU(w 
1
​
 +b 
1
​
 )

Izračunajmo 
𝑠
2
s 
2
​
 :
𝑠
2
=
𝑤
2
⋅
ReLU
(
𝑤
1
+
𝑏
1
)
+
𝑏
2
s 
2
​
 =w 
2
​
 ⋅ReLU(w 
1
​
 +b 
1
​
 )+b 
2
​
 

Izračunajmo softmax izlaze 
𝑦
1
y 
1
​
  i 
𝑦
2
y 
2
​
 :
𝑦
1
=
𝑒
𝑠
1
𝑒
𝑠
1
+
𝑒
𝑠
2
y 
1
​
 = 
e 
s 
1
​
 
 +e 
s 
2
​
 
 
e 
s 
1
​
 
 
​
 
𝑦
2
=
𝑒
𝑠
2
𝑒
𝑠
1
+
𝑒
𝑠
2
y 
2
​
 = 
e 
s 
1
​
 
 +e 
s 
2
​
 
 
e 
s 
2
​
 
 
​
 

Izračunajmo gradijente gubitka:
∂
𝐿
∂
𝑠
1
=
𝑦
1
−
1
∂s 
1
​
 
∂L
​
 =y 
1
​
 −1
∂
𝐿
∂
𝑠
2
=
𝑦
2
∂s 
2
​
 
∂L
​
 =y 
2
​
 

Izračunajmo gradijente u odnosu na 
𝑤
2
w 
2
​
  i 
𝑏
2
b 
2
​
 :
∂
𝐿
∂
𝑤
2
=
𝑦
2
⋅
ℎ
1
∂w 
2
​
 
∂L
​
 =y 
2
​
 ⋅h 
1
​
 
∂
𝐿
∂
𝑏
2
=
𝑦
2
∂b 
2
​
 
∂L
​
 =y 
2
​
 

Izračunajmo gradijent u odnosu na 
ℎ
1
h 
1
​
 :
∂
𝐿
∂
ℎ
1
=
𝑦
2
⋅
𝑤
2
∂h 
1
​
 
∂L
​
 =y 
2
​
 ⋅w 
2
​
 

Izračunajmo gradijent u odnosu na 
𝑠
1
s 
1
​
 :
∂
𝐿
∂
𝑠
1
=
(
𝑦
1
−
1
)
+
𝑦
2
⋅
𝑤
2
⋅
ReLU
′
(
𝑠
1
)
∂s 
1
​
 
∂L
​
 =(y 
1
​
 −1)+y 
2
​
 ⋅w 
2
​
 ⋅ReLU 
′
 (s 
1
​
 )

{
1
ako 
𝑠
1
>
0
0
ako 
𝑠
1
≤
0
{ 
1
0
​
  
ako s 
1
​
 >0
ako s 
1
​
 ≤0
​
 
Izračunajmo gradijente u odnosu na 
𝑤
1
w 
1
​
  i 
𝑏
1
b 
1
​
 :
∂
𝐿
∂
𝑤
1
=
(
(
𝑦
1
−
1
)
+
𝑦
2
⋅
𝑤
2
⋅
ReLU
′
(
𝑠
1
)
)
⋅
𝑥
∂w 
1
​
 
∂L
​
 =((y 
1
​
 −1)+y 
2
​
 ⋅w 
2
​
 ⋅ReLU 
′
 (s 
1
​
 ))⋅x
∂
𝐿
∂
𝑏
1
=
(
𝑦
1
−
1
)
+
𝑦
2
⋅
𝑤
2
⋅
ReLU
′
(
𝑠
1
)
∂b 
1
​
 
∂L
​
 =(y 
1
​
 −1)+y 
2
​
 ⋅w 
2
​
 ⋅ReLU 
′
 (s 
1
​
 )

Specifične vrijednosti za 
𝑥
=
1
x=1
Pretpostavimo da su:

𝑤
1
=
1
,
𝑏
1
=
0
,
𝑤
2
=
1
,
𝑏
2
=
0
w 
1
​
 =1,b 
1
​
 =0,w 
2
​
 =1,b 
2
​
 =0

Tada su:

𝑠
1
=
1
+
0
=
1
s 
1
​
 =1+0=1
ℎ
1
=
ReLU
(
1
)
=
1
h 
1
​
 =ReLU(1)=1
𝑠
2
=
1
⋅
1
+
0
=
1
s 
2
​
 =1⋅1+0=1
𝑠
=
[
1
,
1
]
s=[1,1]

Softmax izlazi:

𝑦
1
=
𝑒
1
𝑒
1
+
𝑒
1
=
𝑒
2
𝑒
=
1
2
y 
1
​
 = 
e 
1
 +e 
1
 
e 
1
 
​
 = 
2e
e
​
 = 
2
1
​
 
𝑦
2
=
𝑒
1
𝑒
1
+
𝑒
1
=
𝑒
2
𝑒
=
1
2
y 
2
​
 = 
e 
1
 +e 
1
 
e 
1
 
​
 = 
2e
e
​
 = 
2
1
​
 

Gradijenti gubitka:

∂
𝐿
∂
𝑠
1
=
1
2
−
1
=
−
1
2
∂s 
1
​
 
∂L
​
 = 
2
1
​
 −1=− 
2
1
​
 
∂
𝐿
∂
𝑠
2
=
1
2
∂s 
2
​
 
∂L
​
 = 
2
1
​
 

Gradijenti u odnosu na 
𝑤
2
w 
2
​
  i 
𝑏
2
b 
2
​
 :